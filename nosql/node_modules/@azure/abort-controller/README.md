---
ms.openlocfilehash: fe1a29595719e88783616e54c070b9b946052910
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050804"
---
# <a name="azure-abort-controller-library-for-javascript"></a>適用於 JavaScript 的 Azure Abort Controller 程式庫

`@azure/abort-controller` 套件提供 `AbortController` 和 `AbortSignal` 類別。 這些類別與現代瀏覽器內建的 [AbortController](https://developer.mozilla.org/docs/Web/API/AbortController) 及經由[擷取](https://developer.mozilla.org/docs/Web/API/Fetch_API)使用的 `AbortSignal` 相容。
使用 `AbortController` 類別來建立 `AbortSignal` 類別的執行個體，該類別可用來取消接受類型 `AbortSignalLike` 參數的 Azure SDK 中的作業。

## <a name="getting-started"></a>開始使用

### <a name="installation"></a>安裝

使用 npm 安裝此程式庫，如下所示

```
npm install @azure/abort-controller
```

## <a name="key-concepts"></a>重要概念

使用 `AbortController` 來建立 `AbortSignal`，接著將其傳遞至 Azure SDK 作業，以取消擱置的工作。 可透過 `signal` 具現化的屬性`AbortController`來存取 `AbortSignal`。
也可直接以靜態方法傳回 `AbortSignal`，例如 `AbortController.timeout(100)`。
其在 100 毫秒之後會取消。

在具現化的 `AbortController` 上呼叫 `abort()`，會叫用相關聯的 `AbortSignal` 上已註冊的 `abort` 事件接聽程式。
後續在相同控制器上對 `abort()` 發出的任何呼叫都將無效。

`AbortSignal.none` 靜態屬性會傳回無法中止的 `AbortSignal`。

`AbortSignal` 有多個執行個體可連結，以便在父代訊號上呼叫 `abort()` 來中止所有連結的訊號。
此連結為單向，表示父代訊號可能會影響連結的訊號，但連結的訊號不會影響父代訊號。
若要將 `AbortSignals` 連結在一起，請將父代訊號傳遞至 `AbortController` 建構函式。

## <a name="examples"></a>範例

以下範例假設 `doAsyncWork` 是採用屬性包的函式，其中之一是中止訊號。

### <a name="example-1---basic-usage"></a>範例 1 - 基本使用方式

```js
import { AbortController } from "@azure/abort-controller";

const controller = new AbortController();
doAsyncWork({ abortSignal: controller.signal });

// at some point later
controller.abort();
```

### <a name="example-2---aborting-with-timeout"></a>範例 2 - 因逾時而中止

```js
import { AbortController } from "@azure/abort-controller";

const signal = AbortController.timeout(1000);
doAsyncWork({ abortSignal: signal });
```

### <a name="example-3---aborting-sub-tasks"></a>範例 3 - 中止子工作

```js
import { AbortController } from "@azure/abort-controller";

const allTasksController = new AbortController();

const subTask1 = new AbortController(allTasksController.signal);
const subtask2 = new AbortController(allTasksController.signal);

allTasksController.abort(); // aborts allTasksSignal, subTask1, subTask2
subTask1.abort(); // aborts only subTask1
```

### <a name="example-4---aborting-with-parent-signal-or-timeout"></a>範例 4 - 因父代訊號或逾時而中止

```js
import { AbortController } from "@azure/abort-controller";

const allTasksController = new AbortController();

// create a subtask controller that can be aborted manually,
// or when either the parent task aborts or the timeout is reached.
const subTask = new AbortController(allTasksController.signal, AbortController.timeout(100));

allTasksController.abort(); // aborts allTasksSignal, subTask
subTask.abort(); // aborts only subTask
```

## <a name="contributing"></a>參與

如果您希望向此程式庫投稿，請參閱[投稿指南](https://github.com/Azure/azure-sdk-for-js/blob/master/CONTRIBUTING.md)，深入瞭解如何組建與測試程式碼。

![曝光數](https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-js%2Fsdk%2Fcore%2Fabort-controller%2FREADME.png)
