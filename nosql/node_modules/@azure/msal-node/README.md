---
ms.openlocfilehash: 05bea0332c8376e66d4aed62eab42a50c744536d
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050796"
---
# <a name="microsoft-authentication-library-for-node-msal-node"></a>適用於節點的 Microsoft 驗證程式庫 (MSAL 節點)

[![npm 版本](https://img.shields.io/npm/v/@azure/msal-node.svg?style=flat)](https://www.npmjs.com/package/@azure/msal-node/)[![npm 版本](https://img.shields.io/npm/dm/@azure/msal-node.svg)](https://nodei.co/npm/@azure/msal-node/)[![涵蓋範圍狀態](https://coveralls.io/repos/github/AzureAD/microsoft-authentication-library-for-js/badge.svg?branch=dev)](https://coveralls.io/github/AzureAD/microsoft-authentication-library-for-js?branch=dev)

| <a href="https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa" target="_blank">快速入門</a> | <a href="https://aka.ms/aaddevv2" target="_blank">AAD 文件</a> | <a href="https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_node.html" target="_blank">程式庫參考</a> |
| --- | --- | --- |

目前 `msal-node` 正在開發中，請[在此](https://github.com/AzureAD/microsoft-authentication-library-for-js/projects/4)追蹤專案進度。 這份文件也尚未完稿，將隨著我們發行 `alpha` 修補程式而有所變更。 **我們不建議在實際執行環境中使用這項專案**。

1. [關於](#about)
2. [常見問題集](#faq)
3. [版本](#releases)
4. [先決條件](#prerequisites)
5. [安裝](#installation)
6. [使用量](#usage)
7. [範例](#samples)
8. [組建程式庫](#build-and-test)
9. [安全性報告](#security-reporting)
10. [授權](#license)
11. [管理辦法](#we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct)

## <a name="about"></a>關於

MSAL 節點可供應用程式透過 [Azure AD B2C](https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-overview#identity-providers) 服務，來驗證使用 [Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview) 公司與學校帳戶 (AAD)、Microsoft 個人帳戶 (MSA) 和 Facebook、Google、LinkedIn、Microsoft 帳戶等社交身分供應商的使用者。 它也可讓您的應用程式取得權杖，以存取 [Microsoft 雲端](https://www.microsoft.com/enterprise)服務，例如 [Microsoft Graph](https://graph.microsoft.io)。


### <a name="oauth20-grant-types-supported"></a>支援的 OAuth2.0 授與類型：

目前的 Alpha 版本支援您透過下列方式取得權杖：

#### <a name="public-client"></a>公用用戶端：
- 使用 [PKCE](https://oauth.net/2/pkce/) [授與授權程式碼](https://oauth.net/2/grant-types/authorization-code/)
- [授與裝置程式碼](https://oauth.net/2/grant-types/device-code/)
- [授與重新整理權杖](https://oauth.net/2/grant-types/refresh-token/)
- [無訊息流程](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-acquire-cache-tokens#acquiring-tokens-silently-from-the-cache)

#### <a name="confidential-client"></a>機密用戶端：
- 透過用戶端認證[授與授權程式碼](https://oauth.net/2/grant-types/authorization-code/)
- [授與重新整理權杖](https://oauth.net/2/grant-types/refresh-token/)
- [無訊息流程](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-acquire-cache-tokens#acquiring-tokens-silently-from-the-cache)
- [授與用戶端認證](https://oauth.net/2/grant-types/client-credentials/)
- [代理者流程](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow)

**[即將推出]** 我們規劃未來將新增下列支援：
- [整合式 Windows 驗證流程](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#integrated-windows-authentication)
- [使用者名稱和密碼流程](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows#usernamepassword)

如需更多關於 Microsoft 驗證程式庫普遍支援的不同授與類型詳細資訊，請參閱[此處](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-authentication-flows)。

### <a name="scenarios-supported"></a>支援的案例：

此程式庫支援的案例如下：
- 呼叫 Web API 的傳統型應用程式
- 呼叫 Web API 的 Web 應用程式
- 呼叫 Web API 的 Web API
- 精靈應用程式

如需更多關於案例及其對應的驗證流程詳細資訊，請參閱[此處](https://docs.microsoft.com/en-us/azure/active-directory/develop/authentication-flows-app-scenarios)。

## <a name="faq"></a>常見問題集

請參閱 [這裡](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/faq.md)。

## <a name="prerequisites"></a>Prerequisites

使用 `@azure/msal-node` 之前，您必須在 Azure 入口網站註冊您的應用程式：

- [應用程式註冊](https://docs.microsoft.com/en-us/graph/auth-register-app-v2)

## <a name="installation"></a>安裝

### <a name="via-npm"></a>透過 NPM：
```javascript
npm install @azure/msal-node
```
##  <a name="usage"></a>使用方式

### <a name="msal-basics"></a>MSAL 基本知識
- [瞭解公用用戶端與機密用戶端之間的差異](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-client-applications)
- [初始化公用用戶端應用程式](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/initialize-public-client-application.md)
- [初始化機密用戶端應用程式](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/initialize-confidential-client-application.md)
- [Configuration](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-node/docs/configuration.md)
- [要求](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/request.md)
- [回應](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/response.md)

## <a name="samples"></a>範例
存放庫中包含多個使用 MSAL 節點來取得權杖的[範例](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples)。 這些範例目前用於手動測試，而且並非最佳做法的參考資料，因此請自行判斷，切勿一律將此程式碼複製到任何實際執行應用程式。

- [auth-code](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/auth-code)：使用 OAuth2.0 授權程式碼流程的 Express 應用程式。
- [device-code](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/device-code)：使用 OAuth2.0 裝置程式碼流程的命令列應用程式。
- [refresh-token](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/refresh-token)：使用 OAuth2.0 重新整理流程的命令列應用程式。
- [silent-flow](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/silent-flow)：使用 OAuth2.0 授權程式碼流程以取得權杖並儲存在權杖快取中的 Express 應用程式，以及在權杖快取中使用權杖的無訊息流程。
- [client-credentials](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/client-credentials)：使用 OAuth2.0 授與用戶端認證以取得權杖的 Daemon 應用程式。
- [on-behalf-of](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-node-samples/standalone-samples/on-behalf-of)：使用 OAuth2.0 驗證程式碼流程以取得 Web API 權杖的 Web 應用程式。 Web API 會驗證權杖，並代表在 Web 應用程式中驗證的使用者呼叫 Microsoft Graph。
- [msal-node-extensions](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/extensions/samples/msal-node-extensions)：使用驗證程式碼流程以取得 Web API 權杖，並利用 [msal 延伸模組](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/extensions/)程式庫將 MSAL 記憶體內部權杖快取寫入磁碟。

## <a name="build-and-test"></a>組建與測試

- 如果您未安裝 [lerna](https://github.com/lerna/lerna)，請執行 `npm install -g lerna`
- 從 `microsoft-authentication-library-for-js.git` 的任何位置執行 `lerna bootstrap`。
- 瀏覽至 `microsoft-authentication-library-for-js/lib/msal-common` 並執行 `npm run build`
- 瀏覽至 `microsoft-authentication-library-for-js/lib/msal-node` 並執行 `npm run build`

```javascript
// to link msal-node and msal-common packages
lerna bootstrap

// Change to the msal-node package directory
cd lib/msal-common/

// To run build only for node package
npm run build

// Change to the msal-node package directory
cd lib/msal-node/

// To run build only for node package
npm run build
```

### <a name="local-development"></a>本機開發
以下是可能對您有幫助的命令清單：

#### `npm run build:modules:watch`
在開發/監看模式中執行專案。 您的專案一有任何變更便會重建。 TSDX 有特殊的記錄器可供您使用。 系統會清楚印出錯誤訊息，其格式與 [VS Code 問題] 索引標籤相容。若您進行編輯，程式庫將會重建。

#### `npm run build`
將套件組合至 `dist` 資料夾。
套件已最佳化，並與 Rollup 組合成多種格式 (CommonJS、UMD 和 ES 模組)。

#### `lerna bootstrap`
如果您正在開發/監看模式中執行專案，或者已在 `msal-common` 中進行變更，並需要藉此反映整個專案，請執行 `lerna bootstrap` 以連結所有符號。 請注意，`npm install` 將會取消連結所有程式碼，因此建議您在安裝後執行 `lerna bootstrap`。

#### `npm run lint`
使用 Prettier 執行 eslint

#### <a name="npm-test-npm-run-testcoverage-npm-run-testwatch"></a>`npm test`, `npm run test:coverage`, `npm run test:watch`
在互動模式中執行測試監看程式 (Jest)。
根據預設，系統會執行上次認可之後所變更檔案的相關測試。
新增旗標 --coverage 以產生程式碼涵蓋範圍。 不需要進行其他設定。 Jest 可蒐集整個專案中的程式碼涵蓋範圍資訊，包括未經測試的檔案。

## <a name="security-reporting"></a>安全性報告

如果您發現程式庫或服務的安全性問題，請向 [secure@microsoft.com](mailto:secure@microsoft.com) 報告，內容越詳盡越好。 您的提交可望符合 [Microsoft Bounty](http://aka.ms/bugbounty) (Microsoft 賞金) 計畫的賞金資格。 請勿將安全性問題張貼至 GitHub 問題或任何其他公用網站。 我們會在收到資訊後盡快與您連絡。 我們鼓勵您造訪 [此頁面](https://technet.microsoft.com/security/dd252948) 並訂閱資訊安全摘要報告警示，以在安全性事件發生時收到通知。

## <a name="license"></a>授權

Copyright (c) Microsoft Corporation。  著作權所有，並保留一切權利。 已獲 MIT 授權。

## <a name="we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct"></a>我們重視並遵守 Microsoft 開放原始碼管理辦法

此專案採用了 [Microsoft 開放原始碼管理辦法](https://opensource.microsoft.com/codeofconduct/)。 如需詳細資訊，請參閱[管理辦法常見問題集 (英文)](https://opensource.microsoft.com/codeofconduct/faq/)。如果有任何其他疑問或意見，請連絡 [opencode@microsoft.com](mailto:opencode@microsoft.com)。

