
---
<p align="center">
  <strong>
    <a href="https://open-telemetry.github.io/opentelemetry-js-api">API 文件<a/> &nbsp;&nbsp;&bull;&nbsp;&nbsp; <a href="https://github.com/open-telemetry/opentelemetry-js/discussions">取得聯繫 (GitHub 討論)<a/>
  </strong>
</p>

<p align="center">
  <a href="https://github.com/open-telemetry/opentelemetry-js-api/releases">
    <img alt="GitHub release (latest by date including pre-releases)" src="https://img.shields.io/github/v/release/open-telemetry/opentelemetry-js-api?include_prereleases&style=for-the-badge">
  </a>
  <a href="https://codecov.io/gh/open-telemetry/opentelemetry-js-api/branch/main/">
    <img alt="Codecov Status" src="https://img.shields.io/codecov/c/github/open-telemetry/opentelemetry-js-api?style=for-the-badge">
  </a>
  <a href="https://github.com/open-telemetry/opentelemetry-js-api/blob/main/LICENSE">
    <img alt="license" src="https://img.shields.io/badge/license-Apache_2.0-green.svg?style=for-the-badge">
  </a>
  <br/>
  <a href="https://github.com/open-telemetry/opentelemetry-js-api/actions/workflows/docs.yaml">
    <img alt="Build Status" src="https://github.com/open-telemetry/opentelemetry-js-api/actions/workflows/test.yaml/badge.svg?branch=main">
  </a>
  <a href="https://github.com/open-telemetry/opentelemetry-js-api/actions/workflows/test.yaml?query=branch%3Amain">
    <img alt="Build Status" src="https://github.com/open-telemetry/opentelemetry-js-api/actions/workflows/docs.yaml/badge.svg">
  </a>
</p>

---

# <a name="opentelemetry-api-for-javascript"></a>適用於 JavaScript 的 OpenTelemetry API

[![NPM 已發佈版本][npm-img]][npm-url]
[![相依性][dependencies-image]][dependencies-url]
[![開發相依性][devDependencies-image]][devDependencies-url]

此套件提供與 OpenTelemetry API 互動所需的所有項目，包括所有 TypeScript 介面、列舉和無作業實作。 專門用在伺服器和瀏覽器中。

此套件中的方法預設不會執行任何作業。 這表示不論是否已註冊 SDK，程式庫或終端使用者應用程式都可以安全呼叫。 若要產生和匯出遙測資料，您也會需要 SDK，例如 [OpenTelemetry JS SDK][opentelemetry-js]。

## <a name="tracing-quick-start"></a>追蹤快速入門

### <a name="you-will-need"></a>您將需要

- 一個您想檢測的應用程式
- [OpenTelemetry JS SDK][opentelemetry-js]
- Node.js >=8.5.0 (最好是 14+ ) 或與 ECMAScript 5+ 相容的瀏覽器

**注意：** ECMAScript 5+ 相容性僅適用於此套件。 請參閱您用以判斷其最低 ECMAScript 版本的 SDK 文件。

**程式庫建立者請注意：** 只有您的終端使用者才需要　OpenTelemetry SDK。 如果您希望在程式庫中支援 OpenTelemetry，只需使用 OpenTelemetry API。 如需詳細資訊，請參閱[追蹤文件][docs-tracing]。

### <a name="install-dependencies"></a>安裝相依性

```sh
npm install @opentelemetry/api @opentelemetry/tracing
```

### <a name="trace-your-application"></a>追蹤您的應用程式

若要開始使用追蹤，您必須先註冊 SDK。 您使用的 SDK 可為您呼叫註冊方法，但如果您想直接呼叫它們，請參閱文件：[sdk 註冊方法][docs-sdk-registration]。

註冊 SDK 之後，便可以開始和結束跨距。 以下是基本 SDK 註冊和追蹤簡單作業的簡單範例。 此範例每秒會將跨距匯出至主控台一次。 如需更多資訊，請參閱[追蹤文件][docs-tracing]。

```javascript
const { trace }  = require("@opentelemetry/api");
const { BasicTracerProvider, ConsoleSpanExporter, SimpleSpanProcessor }  = require("@opentelemetry/tracing");

// Create and register an SDK
const provider = new BasicTracerProvider();
provider.addSpanProcessor(new SimpleSpanProcessor(new ConsoleSpanExporter()));
trace.setGlobalTracerProvider(provider);

// Acquire a tracer from the global tracer provider which will be used to trace the application
const name = 'my-application-name';
const version = '0.1.0';
const tracer = trace.getTracer(name, version);

// Trace your application by creating spans
async function operation() {
  const span = tracer.startSpan("do operation");

  // mock some work by sleeping 1 second
  await new Promise((resolve, reject) => {
    setTimeout(resolve, 1000);
  })

  span.end();
}

async function main() {
  while (true) {
    await operation();
  }
}

main();
```

## <a name="version-compatibility"></a>版本相容性

由於 npm 安裝程式和節點模組解析演算法有可能允許任何指定套件的兩個以上複本存在於同一個 `node_modules` 結構中，因此 OpenTelemetry API 會利用 `global`　物件上的變數來儲存全域 API。 呼叫 API 套件中的 API 方法時，會檢查這個 `global` API 是否存在，並代為傳送呼叫，而且只有在 API 版本相容時才會這麼做。 這表示，如果套件所相依的 OpenTelemetry API 版本與終端使用者的 API 不相容，此套件便會接收到 API 的無作業實作。

## <a name="upgrade-guidelines"></a>升級指南

### <a name="0210-to-100"></a>0.21.0 到 1.0.0

無重大變更

### <a name="0200-to-0210"></a>0.20.0 到 0.21.0

- [#78](https://github.com/open-telemetry/opentelemetry-js-api/issues/78) `api.context.bind` 引數已反轉，而 `context` 目前是必要引數。
- [#46](https://github.com/open-telemetry/opentelemetry-js-api/issues/46)不再匯出 Noop 類別和單一資料庫。 若要建立 noop 跨距，建議搭配使用 `api.trace.wrapSpanContext` 及 `INVALID_SPAN_CONTEXT`，而不是使用 `NOOP_TRACER`。

### <a name="100-rc3-to-0200"></a>1.0.0-rc.3 到 0.20.0

- 移除不屬於規格的 `TimedEvent`
- 已將 `HttpBaggage` 重新命名為 `HttpBaggagePropagator`
- 已將 [#45](https://github.com/open-telemetry/opentelemetry-js-api/pull/45) `Span#context` 重新命名為 `Span#spanContext`
- 已將 [#47](https://github.com/open-telemetry/opentelemetry-js-api/pull/47) `getSpan`/`setSpan`/`getSpanContext`/`setSpanContext` 移至 `trace` 命名空間
- 已將 [#55](https://github.com/open-telemetry/opentelemetry-js-api/pull/55) `getBaggage`/`setBaggage`/`createBaggage`= 移至 `propagation` 命名空間

## <a name="useful-links"></a>實用連結

- 如需關於 OpenTelemetry 的詳細資訊，請造訪：<https://opentelemetry.io/>
- 如需關於 OpenTelemetry JavaScript 的詳細資訊：<https://github.com/open-telemetry/opentelemetry-js>
- 如需此專案的說明或提供意見反應，請加入 [GitHub 討論][discussions-url]

## <a name="license"></a>授權

Apache 2.0 - 如需詳細資訊，請參閱[授權][license-url]。

[opentelemetry-js]: https://github.com/open-telemetry/opentelemetry-js

[discussions-url]: https://github.com/open-telemetry/opentelemetry-js/discussions
[license-url]: https://github.com/open-telemetry/opentelemetry-js-api/blob/main/LICENSE
[license-image]: https://img.shields.io/badge/license-Apache_2.0-green.svg?style=flat
[dependencies-image]: https://status.david-dm.org/gh/open-telemetry/opentelemetry-js-api.svg
[dependencies-url]: https://david-dm.org/open-telemetry/opentelemetry-js-api
[devDependencies-image]: https://status.david-dm.org/gh/open-telemetry/opentelemetry-js-api.svg?type=dev
[devDependencies-url]: https://david-dm.org/open-telemetry/opentelemetry-js-api?type=dev
[npm-url]: https://www.npmjs.com/package/@opentelemetry/api
[npm-img]: https://badge.fury.io/js/%40opentelemetry%2Fapi.svg
[docs-tracing]: https://github.com/open-telemetry/opentelemetry-js-api/blob/main/docs/tracing.md
[docs-sdk-registration]: https://github.com/open-telemetry/opentelemetry-js-api/blob/main/docs/sdk-registration.md
