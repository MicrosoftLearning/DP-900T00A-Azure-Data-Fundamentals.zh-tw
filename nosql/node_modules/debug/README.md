---
ms.openlocfilehash: 0dad0f9e52c6ad7304b11c25c495ab90d49a7d98
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050883"
---
# <a name="debug"></a>debug
[![組建狀態](https://travis-ci.org/visionmedia/debug.svg?branch=master)](https://travis-ci.org/visionmedia/debug)  [![涵蓋範圍狀態](https://coveralls.io/repos/github/visionmedia/debug/badge.svg?branch=master)](https://coveralls.io/github/visionmedia/debug?branch=master)  [![Slack](https://visionmedia-community-slackin.now.sh/badge.svg)](https://visionmedia-community-slackin.now.sh/) [![OpenCollective](https://opencollective.com/debug/backers/badge.svg)](#backers)
[![OpenCollective](https://opencollective.com/debug/sponsors/badge.svg)](#sponsors)

<img width="647" src="https://user-images.githubusercontent.com/71256/29091486-fa38524c-7c37-11e7-895f-e7ec8e1039b6.png">

一個以 Node.js 核心偵錯技術作為模型的小型 JavaScript 偵錯公用程式。 適用於 Node.js 和網頁瀏覽器。

## <a name="installation"></a>安裝

```bash
$ npm install debug
```

## <a name="usage"></a>使用方式

`debug` 會公開函式；只要將此函式傳遞至模組的名稱，它就會傳回 `console.error` 的裝飾版本，供您向其傳遞偵錯陳述式。 這可供您切換模組的不同組件及整個模組的偵錯輸出。

範例 [_app.js_](./examples/node/app.js)：

```js
var debug = require('debug')('http')
  , http = require('http')
  , name = 'My App';

// fake app

debug('booting %o', name);

http.createServer(function(req, res){
  debug(req.method + ' ' + req.url);
  res.end('hello\n');
}).listen(3000, function(){
  debug('listening');
});

// fake worker of some kind

require('./worker');
```

範例 [_worker.js_](./examples/node/worker.js)：

```js
var a = require('debug')('worker:a')
  , b = require('debug')('worker:b');

function work() {
  a('doing lots of uninteresting work');
  setTimeout(work, Math.random() * 1000);
}

work();

function workb() {
  b('doing some work');
  setTimeout(workb, Math.random() * 2000);
}

workb();
```

`DEBUG` 環境變數可用於根據空格或逗號分隔名稱來啟用這些輸出。

以下是一些範例：

<img width="647" alt="screen shot 2017-08-08 at 12 53 04 pm" src="https://user-images.githubusercontent.com/71256/29091703-a6302cdc-7c38-11e7-8304-7c0b3bc600cd.png">
<img width="647" alt="screen shot 2017-08-08 at 12 53 38 pm" src="https://user-images.githubusercontent.com/71256/29091700-a62a6888-7c38-11e7-800b-db911291ca2b.png">
<img width="647" alt="screen shot 2017-08-08 at 12 53 25 pm" src="https://user-images.githubusercontent.com/71256/29091701-a62ea114-7c38-11e7-826a-2692bedca740.png">

#### <a name="windows-command-prompt-notes"></a>Windows 命令提示備註

##### <a name="cmd"></a>CMD

Windows 使用 `set` 命令來設定環境變數。

```cmd
set DEBUG=*,-not_this
```

範例：

```cmd
set DEBUG=* & node app.js
```

##### <a name="powershell-vs-code-default"></a>PowerShell (VS Code預設)

PowerShell 使用不同語法來設定環境變數。

```cmd
$env:DEBUG = "*,-not_this"
```

範例：

```cmd
$env:DEBUG='app';node app.js
```

接著，照例執行需要進行偵錯的程式。

npm 指令碼範例：
```js
  "windowsDebug": "@powershell -Command $env:DEBUG='*';node app.js",
```

## <a name="namespace-colors"></a>命名空間色彩

每個偵錯執行個體都會根據其命名空間名稱產生對應的色彩。
當您透過視覺化方式剖析偵錯輸出時，這有助於識別偵錯行屬於哪一個偵錯執行個體。

#### <a name="nodejs"></a>Node.js

在 Node.js 中，當 stderr 為 TTY 時，便會啟用色彩。 偵錯的同時，您也 _應該_ 安裝 [`supports-color`](https://npmjs.org/supports-color) 模組，否則偵錯將只會使用少數基本色彩。

<img width="521" src="https://user-images.githubusercontent.com/71256/29092181-47f6a9e6-7c3a-11e7-9a14-1928d8a711cd.png">

#### <a name="web-browser"></a>Web Browser

在可理解 `%c` 格式設定選項的「網路偵測器」上，色彩也會啟用。 這些是 WebKit 網路偵測器、Firefox ([31 版本](https://hacks.mozilla.org/2014/05/editable-box-model-multiple-selection-sublime-text-keys-much-more-firefox-developer-tools-episode-31/) 以後)，以及 Firefox 的 Firebug 外掛程式 (任何版本)。

<img width="524" src="https://user-images.githubusercontent.com/71256/29092033-b65f9f2e-7c39-11e7-8e32-f6f0d8e865c1.png">


## <a name="millisecond-diff"></a>毫秒單位的差異

當您主動開發應用程式時，可以查看 `debug()` 呼叫和下一次呼叫之間相隔的時間。 例如，假設您在要求資源的前後叫用 `debug()`，「+NNNms」便會顯示這些呼叫之間花費了多少時間。

<img width="647" src="https://user-images.githubusercontent.com/71256/29091486-fa38524c-7c37-11e7-895f-e7ec8e1039b6.png">

如果 stdout 不是 TTY，系統便會採用 `Date#toISOString()`，以便更有效地記錄偵錯資訊，如下所示：

<img width="647" src="https://user-images.githubusercontent.com/71256/29091956-6bd78372-7c39-11e7-8c55-c948396d6edd.png">


## <a name="conventions"></a>慣例

如果您在一或多個程式庫中採用這個方式，便 _應該_ 使用程式庫的名稱，讓開發人員可以視需要切換偵錯，而無需花時間猜測名稱。 如果您有一個以上的偵錯工具，便 _應該_ 使用程式庫名稱作為前置詞，並使用「:」來區隔功能。 例如，來自 Connect 的「bodyParser」會是「connect:bodyParser」。  如果您將「*」附加於名稱的結尾，那麼不論 DEBUG 環境變數的設定為何，系統一律會啟用它。  接著，您便可利用它來進行一般輸出及偵錯輸出。

## <a name="wildcards"></a>萬用字元

`*` 字元可作為萬用字元。 例如，假設您的程式庫有名為「connect:bodyParser」、「connect:compress」和「connect:session」的偵錯工具，便可直接執行 `DEBUG=connect:*` 或直接使用 `DEBUG=*` 來執行採用此模組的所有專案，而無需使用 `DEBUG=connect:bodyParser,connect:compress,connect:session` 來列出這三個偵錯工具。

您也可以在偵錯工具前面加上「-」字元，排除特定偵錯工具。
例如，`DEBUG=*,-connect:*` 會包含所有偵錯工具，但開頭為「connect:」的偵錯工具除外。

## <a name="environment-variables"></a>環境變數

執行Node.js時，您可設定一些環境變數來變更偵錯記錄的行為：

| 名稱      | 目的                                         |
|-----------|-------------------------------------------------|
| `DEBUG`   | 啟用/停用特定的偵錯命名空間。 |
| `DEBUG_HIDE_DATE` | 隱藏偵錯輸出中的日期 (非 TTY)。  |
| `DEBUG_COLORS`| 是否要在偵錯輸出中使用色彩。 |
| `DEBUG_DEPTH` | 物件檢查深度。                    |
| `DEBUG_SHOW_HIDDEN` | 顯示已檢查的物件上的隱藏屬性。 |


__注意：__ 開頭為 `DEBUG_` 的環境變數最終會轉換成可搭配 `%o`/`%O` 格式器使用的 Options 物件。
請參閱 [`util.inspect()`](https://nodejs.org/api/util.html#util_util_inspect_object_options) Node.js 文件
查看完整清單。

## <a name="formatters"></a>格式器

偵錯會使用 [printf 樣式](https://wikipedia.org/wiki/Printf_format_string) 的格式化。
以下是官方支援的格式器：

| 格式器 | 表示法 |
|-----------|----------------|
| `%O`      | 物件美化列印在多行上。 |
| `%o`      | 物件美化列印在單行上。 |
| `%s`      | 字串。 |
| `%d`      | 數字 (整數和浮點數)。 |
| `%j`      | JSON。 如果引數包含循環參考，則以字串「[Circular]」取代。 |
| `%%`      | 單一百分比符號 (「%」)。 這不會取用引數。 |


### <a name="custom-formatters"></a>自訂格式器

您可擴充 `debug.formatters` 物件來新增自訂格式器。
例如，如果您想新增支援以將 Buffer 轉譯為具有 `%h` 的十六進位，可執行下列動作：

```js
const createDebug = require('debug')
createDebug.formatters.h = (v) => {
  return v.toString('hex')
}

// …elsewhere
const debug = createDebug('foo')
debug('this is hex: %h', new Buffer('hello world'))
//   foo this is hex: 68656c6c6f20776f726c6421 +0ms
```


## <a name="browser-support"></a>瀏覽器支援

您可使用 [browserify](https://github.com/substack/node-browserify) 來組建瀏覽器就緒的指令碼，或如果您不想自行組建的話，可直接使用 [browserify-as-a-service](https://wzrd.in/) [組建](https://wzrd.in/standalone/debug@latest)。

偵錯的啟用狀態目前由 `localStorage` 保存。
請參考以下情境，假設您擁有 `worker:a` 和 `worker:b`，並希望對兩者進行偵錯。 可使用 `localStorage.debug` 來啟用此功能：

```js
localStorage.debug = 'worker:*'
```

然後重新整理頁面。

```js
a = debug('worker:a');
b = debug('worker:b');

setInterval(function(){
  a('doing some work');
}, 1000);

setInterval(function(){
  b('doing some work');
}, 1200);
```


## <a name="output-streams"></a>輸出資料流

  根據預設，`debug` 會記錄至 stderr，但您可以覆寫 `log` 方法來設定每個命名空間：

範例 [_stdout.js_](./examples/node/stdout.js)：

```js
var debug = require('debug');
var error = debug('app:error');

// by default stderr is used
error('goes to stderr!');

var log = debug('app:log');
// set this namespace to log via console.log
log.log = console.log.bind(console); // don't forget to bind to console!
log('goes to stdout');
error('still goes to stderr!');

// set all output to go via console.info
// overrides all per-namespace log settings
debug.log = console.info.bind(console);
error('now goes to stdout via console.info');
log('still goes to stdout, but via console.info now');
```

## <a name="extend"></a>擴充
您可以直接擴充偵錯工具 
```js
const log = require('debug')('auth');

//creates new debug instance with extended namespace
const logSign = log.extend('sign');
const logLogin = log.extend('login');

log('hello'); // auth hello
logSign('hello'); //auth:sign hello
logLogin('hello'); //auth:login hello
```

## <a name="set-dynamically"></a>動態進行設定

您也可呼叫 `enable()` 方法來動態啟用偵錯：

```js
let debug = require('debug');

console.log(1, debug.enabled('test'));

debug.enable('test');
console.log(2, debug.enabled('test'));

debug.disable();
console.log(3, debug.enabled('test'));

```

列印 ：   
```
1 false
2 true
3 false
```

使用方式 ：  
`enable(namespaces)`  
`namespaces` 可包含以冒號和萬用字元分隔的模式。
   
請注意，若呼叫 `enable()`，會完全覆寫先前設定的 DEBUG 變數 ： 

```
$ DEBUG=foo node -e 'var dbg = require("debug"); dbg.enable("bar"); console.log(dbg.enabled("foo"))'
=> false
```

`disable()`

將停用所有命名空間。 函式會傳回 (及略過) 目前啟用的命名空間。 如果您想暫時停用偵錯，但不知道啟用的開頭內容，可善用此方式。

例如：

```js
let debug = require('debug');
debug.enable('foo:*,-foo:bar');
let namespaces = debug.disable();
debug.enable(namespaces);
```

注意：字串未必會與初始啟用字串相同，但語意上會相同。

## <a name="checking-whether-a-debug-target-is-enabled"></a>檢查偵錯目標是否已啟用

建立偵錯執行個體之後，您可檢查 `enabled` 屬性來判斷它是否已啟用：

```javascript
const debug = require('debug')('http');

if (debug.enabled) {
  // do stuff...
}
```

您也可手動切換此屬性，以強制啟用或停用偵錯執行個體。


## <a name="authors"></a>Authors

 - TJ Holowaychuk
 - Nathan Rajlich
 - Andrew Rhyne

## <a name="backers"></a>贊助人

您可每月捐贈，支援與協助我們繼續開發。 [[成為贊助人](https://opencollective.com/debug#backer)]

<a href="https://opencollective.com/debug/backer/0/website" target="_blank"><img src="https://opencollective.com/debug/backer/0/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/1/website" target="_blank"><img src="https://opencollective.com/debug/backer/1/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/2/website" target="_blank"><img src="https://opencollective.com/debug/backer/2/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/3/website" target="_blank"><img src="https://opencollective.com/debug/backer/3/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/4/website" target="_blank"><img src="https://opencollective.com/debug/backer/4/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/5/website" target="_blank"><img src="https://opencollective.com/debug/backer/5/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/6/website" target="_blank"><img src="https://opencollective.com/debug/backer/6/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/7/website" target="_blank"><img src="https://opencollective.com/debug/backer/7/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/8/website" target="_blank"><img src="https://opencollective.com/debug/backer/8/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/9/website" target="_blank"><img src="https://opencollective.com/debug/backer/9/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/10/website" target="_blank"><img src="https://opencollective.com/debug/backer/10/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/11/website" target="_blank"><img src="https://opencollective.com/debug/backer/11/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/12/website" target="_blank"><img src="https://opencollective.com/debug/backer/12/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/13/website" target="_blank"><img src="https://opencollective.com/debug/backer/13/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/14/website" target="_blank"><img src="https://opencollective.com/debug/backer/14/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/15/website" target="_blank"><img src="https://opencollective.com/debug/backer/15/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/16/website" target="_blank"><img src="https://opencollective.com/debug/backer/16/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/17/website" target="_blank"><img src="https://opencollective.com/debug/backer/17/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/18/website" target="_blank"><img src="https://opencollective.com/debug/backer/18/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/19/website" target="_blank"><img src="https://opencollective.com/debug/backer/19/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/20/website" target="_blank"><img src="https://opencollective.com/debug/backer/20/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/21/website" target="_blank"><img src="https://opencollective.com/debug/backer/21/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/22/website" target="_blank"><img src="https://opencollective.com/debug/backer/22/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/23/website" target="_blank"><img src="https://opencollective.com/debug/backer/23/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/24/website" target="_blank"><img src="https://opencollective.com/debug/backer/24/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/25/website" target="_blank"><img src="https://opencollective.com/debug/backer/25/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/26/website" target="_blank"><img src="https://opencollective.com/debug/backer/26/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/27/website" target="_blank"><img src="https://opencollective.com/debug/backer/27/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/28/website" target="_blank"><img src="https://opencollective.com/debug/backer/28/avatar.svg"></a>
<a href="https://opencollective.com/debug/backer/29/website" target="_blank"><img src="https://opencollective.com/debug/backer/29/avatar.svg"></a>


## <a name="sponsors"></a>贊助者

成為贊助者，便可讓您的標誌及網站連結登上 Github 的讀我檔案。 [[成為贊助者](https://opencollective.com/debug#sponsor)]

<a href="https://opencollective.com/debug/sponsor/0/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/0/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/1/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/1/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/2/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/2/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/3/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/3/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/4/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/4/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/5/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/5/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/6/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/6/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/7/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/7/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/8/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/8/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/9/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/9/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/10/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/10/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/11/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/11/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/12/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/12/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/13/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/13/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/14/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/14/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/15/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/15/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/16/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/16/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/17/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/17/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/18/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/18/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/19/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/19/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/20/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/20/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/21/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/21/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/22/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/22/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/23/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/23/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/24/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/24/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/25/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/25/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/26/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/26/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/27/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/27/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/28/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/28/avatar.svg"></a>
<a href="https://opencollective.com/debug/sponsor/29/website" target="_blank"><img src="https://opencollective.com/debug/sponsor/29/avatar.svg"></a>

## <a name="license"></a>授權

(MIT 授權)

版權所有 (c) 2014-2017 TJ Holowaychuk &lt;tj@vision-media.ca&gt;

在此免費授與權限給任何取得本軟體副本與相關文件檔案 (以下簡稱「軟體」) 的人員，以供其在不受限制的情況下處理軟體，包括但不限於使用、複製、修改、合併、發佈、散布、再授權及/或銷售軟體副本的權利，以及允許作為軟體提供對象的人員這麼做，但須遵守下列條件：

上述著作權聲明和此權限聲明應包含在「軟體」的所有複本或重要部分中。

軟體係依「現況」提供，不附帶任何形式的明示或默示擔保，包括但不限於商品的適售性或某特定目的之合適性及未侵權。
作者或著作權持有者對於任何索賠、損害或其他責任，均不負任何責任，不論是起因於、出自或連結至軟體或軟體的使用或其他交易所造成的訴訟或合約、侵權或其他事由。
