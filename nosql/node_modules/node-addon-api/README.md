---
ms.openlocfilehash: 5f4ff1937c647160a418ca9c807267dc22e5e09f
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050816"
---
注意：預設的分支已重新命名！
master 現已命名為 main

如果您有本機複製品，可執行下列命令進行更新：

```shell
git branch -m master main
git fetch origin
git branch -u origin/main main
```

# <a name="node-addon-api-module"></a>**node-addon-api 模組**
此模組包含 **僅限標題的 C++ 包裝函式類別**，可簡化使用 C++ 時，Node.js 所提供以 C 為基礎的 [Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html)。 它提供 C++ 物件模型和例外狀況，可在低負荷的條件下處理語意。

有三個選項可實作附加元件：Node-API、nan，或直接使用內部 V8、libuv 和 Node.js 程式庫。 除非您需要直接存取如 Node.js 核心中 [C/C++ 附加元件](https://nodejs.org/dist/latest/docs/api/addons.html) 所述，未經 Node-API 公開的功能，否則請使用 Node-API。 關於 Node-API 的詳細資訊，請參閱[使用 Node-API 的 C/C++ 附加元件](https://nodejs.org/dist/latest/docs/api/n-api.html)。

Node-API 是 Node.js 提供的 ABI 穩定 C 介面，用以組建原生附加元件。 它獨立於基礎 JavaScript 執行階段之外 (如 V8 或 ChakraCore)，並始終作為 Node.js 本身的一部分。 其旨在避免原生附加元件受到基礎 JavaScript 引擎中的變更所影響，並讓專為某一版本編譯的模組無需進行重新編譯，也可在更新版本的 Node.js 上運作。

不屬於 Node.js 的 `node-addon-api` 模組保有 Node-API 的優點，因為它只包含單純取決於 Node-API 所提供穩定 API 的內嵌程式碼。 因此，針對使用 node-addon-api 之 Node.js 版本所組建的模組，無需透過較新版本的 Node.js 重建，也能運作。

請務必記住，透過 *其他* Node.js 介面，例如 `libuv` (經由 `#include <uv.h>` 包含在一項專案中)，在各種 Node.js 主要版本中並不具有 ABI 穩定性。 因此，附加元件只能使用 Node-API 和/或 `node-addon-api`，並針對包含實作的 Node-API 的 Node.js 版本進行組建 (意即使用中的 Node.js LTS 版本)，以在各種 Node.js 主要版本中享有 ABI 穩定性。 Node.js 提供 [ABI 穩定性指南][]，其中詳細說明了一般 ABI 穩定性，尤其是 Node-API ABI 穩定性保證。

將新的 API 新增至 Node-API 時，您必須更新 node-addon-api，為新的 API 提供包裝函式。 因此，node-addon-api 提供了一些方法，可供呼叫端取得基礎 Node-API 控制代碼以便直接呼叫 Node-API，也可同時使用 node-addon-api 所提供的物件/方法。 例如，使用 node-addon-api 尚未提供包裝函式的 API。

node-addon-api 公開的 API 一般用於建立和操作 JavaScript 值。 概念和作業通常會對應 **ECMA262 語言規格** 中指明的想法。

[Node-API Resource](https://nodejs.github.io/node-addon-examples/)  為剛開始使用 Node-API 和 node-addon-api 的開發人員提供絕佳的方向和秘訣。

- **[安裝程式](#setup)**
- **[API 文件](#api)**
- **[範例](#examples)**
- **[測試](#tests)**
- **[關於原生附加元件的更多資源和資訊](#resources)**
- **[徽章](#badges)**
- **[管理辦法](CODE_OF_CONDUCT.md)**
- **[參與者](#contributors)**
- **[授權](#license)**

## <a name="current-version-321"></a>**目前版本：3.2.1**

(請參閱 [CHANGELOG.md](CHANGELOG.md) 以全面瞭解 Changelog)

[![NPM](https://nodei.co/npm/node-addon-api.png?downloads=true&downloadRank=true)](https://nodei.co/npm/node-addon-api/) [![NPM](https://nodei.co/npm-dl/node-addon-api.png?months=6&height=1)](https://nodei.co/npm/node-addon-api/)

<a name="setup"></a>

node-addon-api 以 [Node-API](https://nodejs.org/api/n-api.html) 為基礎，並支援使用不同的 Node-API 版本。
這可讓利用它所組建的附加元件與 Node-API 版本 (此版本支援目標 Node-API 版本) 共同運作。
**然而**，node-addon-api 支援模型僅支援作用中的 LTS Node.js版本。 這表示每年都會有新的主要版本，會停止支援已失效的 Node.js LTS 版本。

目前的 node-addon-api 版本所支援的最舊 Node.js 版本是 Node.js 10.x。

## <a name="setup"></a>安裝程式
  - [安裝和使用方式](doc/setup.md)
  - [node-gyp](doc/node-gyp.md)
  - [cmake-js](doc/cmake-js.md)
  - [轉換工具](doc/conversion-tool.md)
  - [檢查程式工具](doc/checker-tool.md)
  - [Generator](doc/generator.md)
  - [預先建置工具](doc/prebuild_tools.md)

<a name="api"></a>

### <a name="api-documentation"></a>**API 文件**

以下是 node-addon-api 的文件。

 - [完整類別階層](doc/hierarchy.md)
 - [附加元件結構](doc/addon.md)
 - 資料類型：
    - [Env](doc/env.md)
    - [CallbackInfo](doc/callbackinfo.md)
    - [參考](doc/reference.md)
    - [ReplTest1](doc/value.md)
        - [名稱](doc/name.md)
            - [符號](doc/symbol.md)
            - [String](doc/string.md)
        - [Number](doc/number.md)
        - [日期](doc/date.md)
        - [BigInt](doc/bigint.md)
        - [布林值](doc/boolean.md)
        - [外部](doc/external.md)
        - [Object](doc/object.md)
            - [陣列](doc/array.md)
            - [ObjectReference](doc/object_reference.md)
    - [PropertyDescriptor](doc/property_descriptor.md)
    - [Function](doc/function.md)
        - [FunctionReference](doc/function_reference.md)
    - [ObjectWrap](doc/object_wrap.md)
        - [ClassPropertyDescriptor](doc/class_property_descriptor.md)
    - [Buffer](doc/buffer.md)
    - [ArrayBuffer](doc/array_buffer.md)
    - [TypedArray](doc/typed_array.md)
      - [TypedArrayOf](doc/typed_array_of.md)
    - [DataView](doc/dataview.md)
 - [錯誤處理](doc/error_handling.md)
    - [錯誤](doc/error.md)
      - [TypeError](doc/type_error.md)
      - [RangeError](doc/range_error.md)
 - [物件存留期管理](doc/object_lifetime_management.md)
    - [HandleScope](doc/handle_scope.md)
    - [EscapableHandleScope](doc/escapable_handle_scope.md)
 - [記憶體管理](doc/memory_management.md)
 - [非同步作業](doc/async_operations.md)
    - [AsyncWorker](doc/async_worker.md)
    - [AsyncContext](doc/async_context.md)
    - [AsyncWorker 變數](doc/async_worker_variants.md)
 - [多個安全執行緒函數](doc/threadsafe.md)
    - [ThreadSafeFunction](doc/threadsafe_function.md)
    - [TypedThreadSafeFunction](doc/typed_threadsafe_function.md)
 - [Promise](doc/promises.md)
 - [版本管理](doc/version_management.md)

<a name="examples"></a>

### <a name="examples"></a>**範例**

您不熟悉 **node-addon-api** 嗎？ 請參照 **[範例](https://github.com/nodejs/node-addon-examples)**

- **[Hello World](https://github.com/nodejs/node-addon-examples/tree/HEAD/1_hello_world/node-addon-api)**
- **[將引數傳遞至函數](https://github.com/nodejs/node-addon-examples/tree/HEAD/2_function_arguments/node-addon-api)**
- **[回撥](https://github.com/nodejs/node-addon-examples/tree/HEAD/3_callbacks/node-addon-api)**
- **[物件中心](https://github.com/nodejs/node-addon-examples/tree/HEAD/4_object_factory/node-addon-api)**
- **[函式中心](https://github.com/nodejs/node-addon-examples/tree/HEAD/5_function_factory/node-addon-api)**
- **[包裝 C++ 物件](https://github.com/nodejs/node-addon-examples/tree/HEAD/6_object_wrap/node-addon-api)**
- **[包裝物件的中心](https://github.com/nodejs/node-addon-examples/tree/HEAD/7_factory_wrap/node-addon-api)**
- **[傳送包裝物件](https://github.com/nodejs/node-addon-examples/tree/HEAD/8_passing_wrapped/node-addon-api)**

<a name="tests"></a>

### <a name="tests"></a>**測試**

若要執行 **node-addon-api** 測試，請：

```
npm install
npm test
```

避免測試 API 執行的已取代部分
```
npm install
npm test --disable-deprecated
```

執行針對特定版本 Node-API 的測試
```
npm install
export NAPI_VERSION=X
npm test --NAPI_VERSION=X
```

在其運作環境中，X 是您的目標 Node-API 版本。

### <a name="debug"></a>**偵錯**

利用 `--debug` 選項執行 **node-addon-api** 測試：

```
npm run-script dev
```

如果您希望加速組建，可採用以下選項：

```
npm run-script dev:incremental
```

查看並從我們的 **[測試套件](https://github.com/nodejs/node-addon-api/tree/HEAD/test)** 中獲取靈感

### <a name="benchmarks"></a>**效能評定**

您可利用下列命令來執行可用的基準：

```
npm run-script benchmark
```

如需更多關於執行和新增基準的詳細資料，請參閱 [benchmark/README.md](benchmark/README.md)。

<a name="resources"></a>

### <a name="more-resource-and-info-about-native-addons"></a>**關於原生附加元件的更多資源和資訊**
- **[C++ 附加元件](https://nodejs.org/dist/latest/docs/api/addons.html)**
- **[Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html)**
- **[Node-API - 原生模組的下一代 Node API](https://youtu.be/-Oniup60Afs)**
- **[如何將 Realm JavaScript 從 NAN 遷移至 Node-API](https://developer.mongodb.com/article/realm-javascript-nan-to-n-api)**

由於 node-addon-api 的核心任務是將一般的 C Node-API 公開為 C++ 包裝函式，因此輔助 n-api/node-addon-api 工具以更方便地利用 n-api/node-addon-api 來開發 Node.js 附加元件的工具就可以發佈至 NPM 作為獨立套件。 此外，建議您使用 `node-addon-api` 標記這類套件，以提高其在社群中的可見度。

NPM 搜尋快速連結：[keywords:node-addon-api](https://www.npmjs.com/search?q=keywords%3Anode-addon-api)。

<a name="other-bindings"></a>

### <a name="other-bindings"></a>**其他繫結**

- **[napi-rs](https://napi.rs)** - (`Rust`)

<a name="badges"></a>

### <a name="badges"></a>**徽章**

建議使用徽章來指出模組對於 Node-API 版本的最低要求。 這有助於您判斷支援哪些 Node.js 主要版本。 附加元件維護人員可查閱 [Node-API 支援矩陣][]，以判斷哪些 Node.js 版本提供指定的 Node-API 版本。 可用的徽章如下：

![Node-API v1 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v1%20Badge.svg)
![Node-API v2 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v2%20Badge.svg)
![Node-API v3 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v3%20Badge.svg)
![Node-API v4 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v4%20Badge.svg)
![Node-API v5 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v5%20Badge.svg)
![Node-API v6 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v6%20Badge.svg)
![Node-API v7 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v7%20Badge.svg)
![Node-API v8 徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20v8%20Badge.svg)
![Node-API 實驗版本徽章](https://github.com/nodejs/abi-stable-node/blob/doc/assets/Node-API%20Experimental%20Version%20Badge.svg)

## <a name="contributing"></a>**參與**

我們非常歡迎社群參與改善 **node-addon-api**！
如需擴充此模組原理的詳細資訊，請參閱 [CONTRIBUTING.md](CONTRIBUTING.md)。

<a name="contributors"></a>

## <a name="team-members"></a>小組成員

### <a name="active"></a>使用中
| 名稱                | GitHub 連結                                           |
| ------------------- | ----------------------------------------------------- |
| Anna Henningsen     | [addaleax](https://github.com/addaleax)               |
| Chengzhong Wu       | [legendecas](https://github.com/legendecas)           |
| Gabriel Schulhof    | [gabrielschulhof](https://github.com/gabrielschulhof) |
| Jim Schlight        | [jschlight](https://github.com/jschlight)             |
| Michael Dawson      | [mhdawson](https://github.com/mhdawson)               |
| Kevin Eady          | [KevinEady](https://github.com/KevinEady)
| Nicola Del Gobbo    | [NickNaso](https://github.com/NickNaso)               |

### <a name="emeritus"></a>榮譽
| 名稱                | GitHub 連結                                           |
| ------------------- | ----------------------------------------------------- |
| Arunesh Chandra     | [aruneshchandra](https://github.com/aruneshchandra)   |
| Benjamin Byholm     | [kkoopa](https://github.com/kkoopa)                   |
| Jason Ginchereau    | [jasongin](https://github.com/jasongin)               |
| Hitesh Kanwathirtha | [digitalinfinity](https://github.com/digitalinfinity) |
| Sampson Gao         | [sampsongao](https://github.com/sampsongao)           |
| Taylor Woll         | [boingoing](https://github.com/boingoing)             |

<a name="license"></a>

[MIT](./LICENSE.md) 授權

[ABI 穩定性指南]: https://nodejs.org/en/docs/guides/abi-stability/
[Node-API 支援矩陣]: https://nodejs.org/dist/latest/docs/api/n-api.html#n_api_n_api_version_matrix
